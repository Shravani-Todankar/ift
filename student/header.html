<!-- Top Navigation Header -->
<header class="top-header">

    <!-- Desktop Navigation -->
    <div class="header-nav d-none d-lg-flex flex-grow-1 justify-content-end gap-4">
        <div class="d-flex align-items-center gap-4 me-4">
            <a class="nav-link-header" href="dashboard.html">Dashboard</a>
            <a class="nav-link-header" href="#">Challenges</a>
            <a class="nav-link-header active" href="team-management.html">Team</a>
            <a class="nav-link-header" href="#">Resources</a>
        </div>
        <div class="d-flex gap-2">
            <button class="header-icon-btn">
                <span class="material-symbols-outlined">notifications</span>
            </button>
            <button class="header-icon-btn">
                <span class="material-symbols-outlined">help</span>
            </button>
        </div>
        <div class="header-avatar" style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBjmsevs-ZsRszOHPAXJj0i4FzcVtWfKjpbgsjZuE5f57sKyUVBxVJZzXNcerOf8kAeRjiPR8sbDRxh6yZsPEkqBRsQuBCNKO6W2UUSvl4tGso_jAC5DOEIuAYDlnxS_POeaeIGpHCMCZzN4zKzMod48W6_yXLxVhR7jYbRpokBTt6XbkxWV5Jd1PFhFcQbGD_Gp6IBO4cHJhKTo5VHhVdRf7yXk5xU-vDDwYrnMst2nJZYu2eGTdeROYNudGxZ_OvdLotQ49jOWTg");'></div>
    </div>

    <!-- Mobile Menu Icon -->
    <div class="d-lg-none d-flex align-items-center">
        <button class="header-icon-btn" id="mobileMenuBtn">
            <span class="material-symbols-outlined">menu</span>
        </button>
    </div>
</header>

<!-- Notification Panel (Initially Hidden) -->
<div id="notificationPanel" style="display: none; position: fixed; top: 70px; right: 20px; width: 360px; max-height: 500px; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); z-index: 9999; overflow: hidden;">
    <div style="padding: 16px; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center;">
        <h3 style="margin: 0; font-size: 1rem; font-weight: 700; color: #0f172a;">Notifications</h3>
        <button id="closeNotificationPanel" style="background: none; border: none; cursor: pointer; color: #94a3b8;">
            <span class="material-symbols-outlined" style="font-size: 20px;">close</span>
        </button>
    </div>
    <div style="max-height: 400px; overflow-y: auto; padding: 8px;">
        <div class="notification-item" style="padding: 12px; border-radius: 8px; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <div style="display: flex; gap: 12px;">
                <div style="width: 32px; height: 32px; border-radius: 50%; background: #dcfce7; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <span class="material-symbols-outlined" style="font-size: 16px; color: #16a34a;">group_add</span>
                </div>
                <div style="flex: 1;">
                    <p style="margin: 0; font-size: 0.875rem; font-weight: 600; color: #1e293b;">New Teammate Joined</p>
                    <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #64748b;">Priya Singh has joined your team</p>
                    <p style="margin: 4px 0 0 0; font-size: 0.625rem; color: #94a3b8;">2 hours ago</p>
                </div>
            </div>
        </div>
        <div class="notification-item" style="padding: 12px; border-radius: 8px; cursor: pointer; background: rgba(47, 13, 242, 0.05); border-left: 2px solid #2f0df2;" onmouseover="this.style.backgroundColor='rgba(47, 13, 242, 0.08)'" onmouseout="this.style.backgroundColor='rgba(47, 13, 242, 0.05)'">
            <div style="display: flex; gap: 12px;">
                <div style="width: 32px; height: 32px; border-radius: 50%; background: rgba(47, 13, 242, 0.2); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <span class="material-symbols-outlined" style="font-size: 16px; color: #2f0df2;">priority_high</span>
                </div>
                <div style="flex: 1;">
                    <p style="margin: 0; font-size: 0.875rem; font-weight: 600; color: #1e293b;">Deadline Approaching</p>
                    <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #64748b;">Submission due in 5 days</p>
                    <p style="margin: 4px 0 0 0; font-size: 0.625rem; color: #94a3b8;">1 day ago</p>
                </div>
            </div>
        </div>
        <div class="notification-item" style="padding: 12px; border-radius: 8px; cursor: pointer; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <div style="display: flex; gap: 12px;">
                <div style="width: 32px; height: 32px; border-radius: 50%; background: #f3e8ff; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <span class="material-symbols-outlined" style="font-size: 16px; color: #9333ea;">campaign</span>
                </div>
                <div style="flex: 1;">
                    <p style="margin: 0; font-size: 0.875rem; font-weight: 600; color: #1e293b;">Webinar Alert</p>
                    <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #64748b;">Workshop starting tomorrow at 4 PM</p>
                    <p style="margin: 4px 0 0 0; font-size: 0.625rem; color: #94a3b8;">2 days ago</p>
                </div>
            </div>
        </div>
    </div>
    <div style="padding: 12px; border-top: 1px solid #f1f5f9; text-align: center;">
        <button style="width: 100%; padding: 8px; background: none; border: none; color: #2f0df2; font-weight: 500; cursor: pointer; font-size: 0.875rem;" onmouseover="this.style.textDecoration='underline'" onmouseout="this.style.textDecoration='none'">View All Notifications</button>
    </div>
</div>

<!-- Help Modal (Initially Hidden) -->
<div id="helpModal" style="display: none; position: fixed; top: 70px; right: 20px; width: 320px; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); z-index: 9999; overflow: hidden;">
    <div style="padding: 16px; border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center;">
        <h3 style="margin: 0; font-size: 1rem; font-weight: 700; color: #0f172a;">Help & Support</h3>
        <button id="closeHelpModal" style="background: none; border: none; cursor: pointer; color: #94a3b8;">
            <span class="material-symbols-outlined" style="font-size: 20px;">close</span>
        </button>
    </div>
    <div style="padding: 16px;">
        <a href="#faq" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2;">help_center</span>
            <span style="font-weight: 500; font-size: 0.875rem;">FAQ</span>
        </a>
        <a href="#guide" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2;">menu_book</span>
            <span style="font-weight: 500; font-size: 0.875rem;">User Guide</span>
        </a>
        <a href="#contact" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2;">support_agent</span>
            <span style="font-weight: 500; font-size: 0.875rem;">Contact Support</span>
        </a>
        <a href="#feedback" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2;">feedback</span>
            <span style="font-weight: 500; font-size: 0.875rem;">Send Feedback</span>
        </a>
    </div>
</div>

<!-- Mobile Menu Panel (Initially Hidden) -->
<div id="mobileMenuPanel" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9998;" onclick="closeMobileMenu()">
    <div style="position: absolute; top: 0; right: 0; width: 280px; height: 100%; background: white; box-shadow: -2px 0 8px rgba(0,0,0,0.1); padding: 20px;" onclick="event.stopPropagation()">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px;">
            <h3 style="margin: 0; font-size: 1.125rem; font-weight: 700;">Menu</h3>
            <button onclick="closeMobileMenu()" style="background: none; border: none; cursor: pointer; color: #94a3b8;">
                <span class="material-symbols-outlined" style="font-size: 24px;">close</span>
            </button>
        </div>
        <nav style="display: flex; flex-direction: column; gap: 8px;">
            <a href="dashboard.html" style="padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; font-weight: 500; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f1f5f9'" onmouseout="this.style.backgroundColor='transparent'">Dashboard</a>
            <a href="#" style="padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; font-weight: 500; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f1f5f9'" onmouseout="this.style.backgroundColor='transparent'">Challenges</a>
            <a href="team-management.html" style="padding: 12px; border-radius: 8px; text-decoration: none; color: #2f0df2; font-weight: 700; background: rgba(47, 13, 242, 0.1);">Team</a>
            <a href="#" style="padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; font-weight: 500; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f1f5f9'" onmouseout="this.style.backgroundColor='transparent'">Resources</a>
        </nav>
    </div>
</div>

<!-- Profile Dropdown (Initially Hidden) -->
<div id="profileDropdown" style="display: none; position: fixed; top: 70px; right: 20px; width: 280px; background: white; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); z-index: 9999; overflow: hidden;">
    <!-- User Info Section -->
    <div style="padding: 16px; border-bottom: 1px solid #f1f5f9;">
        <div style="display: flex; align-items: center; gap: 12px;">
            <div style="width: 48px; height: 48px; border-radius: 50%; background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuBjmsevs-ZsRszOHPAXJj0i4FzcVtWfKjpbgsjZuE5f57sKyUVBxVJZzXNcerOf8kAeRjiPR8sbDRxh6yZsPEkqBRsQuBCNKO6W2UUSvl4tGso_jAC5DOEIuAYDlnxS_POeaeIGpHCMCZzN4zKzMod48W6_yXLxVhR7jYbRpokBTt6XbkxWV5Jd1PFhFcQbGD_Gp6IBO4cHJhKTo5VHhVdRf7yXk5xU-vDDwYrnMst2nJZYu2eGTdeROYNudGxZ_OvdLotQ49jOWTg'); background-size: cover; background-position: center; border: 2px solid #2f0df2;"></div>
            <div style="flex: 1; overflow: hidden;">
                <p style="margin: 0; font-size: 0.875rem; font-weight: 700; color: #0f172a; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Rohan Sharma</p>
                <p style="margin: 4px 0 0 0; font-size: 0.75rem; color: #64748b; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">Student â€¢ Grade 11</p>
                <p style="margin: 2px 0 0 0; font-size: 0.625rem; color: #94a3b8; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">rohan.sharma@student.ift.org</p>
            </div>
        </div>
    </div>

    <!-- Menu Items -->
    <div style="padding: 8px;">
        <a href="#profile" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2; font-size: 20px;">person</span>
            <span style="font-weight: 500; font-size: 0.875rem;">My Profile</span>
        </a>
        <a href="team-management.html" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2; font-size: 20px;">group</span>
            <span style="font-weight: 500; font-size: 0.875rem;">My Team</span>
        </a>
        <a href="#submissions" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2; font-size: 20px;">folder_open</span>
            <span style="font-weight: 500; font-size: 0.875rem;">My Submissions</span>
        </a>
        <a href="#achievements" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #2f0df2; font-size: 20px;">emoji_events</span>
            <span style="font-weight: 500; font-size: 0.875rem;">Achievements</span>
        </a>
        <div style="height: 1px; background: #f1f5f9; margin: 8px 0;"></div>
        <a href="#settings" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #0f172a; transition: background 0.2s;" onmouseover="this.style.backgroundColor='#f8fafc'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #64748b; font-size: 20px;">settings</span>
            <span style="font-weight: 500; font-size: 0.875rem;">Settings</span>
        </a>
        <a href="#" id="logoutLink" style="display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; text-decoration: none; color: #ef4444; transition: background 0.2s;" onmouseover="this.style.backgroundColor='rgba(239, 68, 68, 0.1)'" onmouseout="this.style.backgroundColor='transparent'">
            <span class="material-symbols-outlined" style="color: #ef4444; font-size: 20px;">logout</span>
            <span style="font-weight: 600; font-size: 0.875rem;">Logout</span>
        </a>
    </div>
</div>

<script>
    // Header JavaScript Functionality
    (function() {
        // Set active navigation link based on current page
        function setActiveNavLink() {
            const currentPage = window.location.pathname.split('/').pop() || 'dashboard.html';
            const navLinks = document.querySelectorAll('.nav-link-header');

            navLinks.forEach(link => {
                const href = link.getAttribute('href');

                // Remove active class from all
                link.classList.remove('active');

                // Add active class to matching link
                if (href === currentPage ||
                    (currentPage === '' && href === 'dashboard.html') ||
                    (currentPage === 'index.html' && href === 'dashboard.html')) {
                    link.classList.add('active');
                }
            });
        }

        // Notification panel toggle
        function initNotificationPanel() {
            const notificationBtn = document.querySelector('.header-icon-btn:has(.material-symbols-outlined:contains("notifications"))');
            const allBtns = document.querySelectorAll('.header-icon-btn');

            // Find notification button
            let notifBtn = null;
            allBtns.forEach(btn => {
                const icon = btn.querySelector('.material-symbols-outlined');
                if (icon && icon.textContent.trim() === 'notifications') {
                    notifBtn = btn;
                }
            });

            const notificationPanel = document.getElementById('notificationPanel');
            const closeBtn = document.getElementById('closeNotificationPanel');

            if (notifBtn && notificationPanel) {
                notifBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const helpModal = document.getElementById('helpModal');
                    if (helpModal) helpModal.style.display = 'none';

                    notificationPanel.style.display = notificationPanel.style.display === 'none' ? 'block' : 'none';

                    // Add animation
                    if (notificationPanel.style.display === 'block') {
                        notificationPanel.style.animation = 'slideDown 0.3s ease';
                    }
                });
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    notificationPanel.style.display = 'none';
                });
            }

            // Close when clicking outside
            document.addEventListener('click', function(e) {
                if (notificationPanel && !notificationPanel.contains(e.target) &&
                    notifBtn && !notifBtn.contains(e.target)) {
                    notificationPanel.style.display = 'none';
                }
            });
        }

        // Help modal toggle
        function initHelpModal() {
            const allBtns = document.querySelectorAll('.header-icon-btn');

            // Find help button
            let helpBtn = null;
            allBtns.forEach(btn => {
                const icon = btn.querySelector('.material-symbols-outlined');
                if (icon && icon.textContent.trim() === 'help') {
                    helpBtn = btn;
                }
            });

            const helpModal = document.getElementById('helpModal');
            const closeBtn = document.getElementById('closeHelpModal');

            if (helpBtn && helpModal) {
                helpBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    const notificationPanel = document.getElementById('notificationPanel');
                    if (notificationPanel) notificationPanel.style.display = 'none';

                    helpModal.style.display = helpModal.style.display === 'none' ? 'block' : 'none';

                    // Add animation
                    if (helpModal.style.display === 'block') {
                        helpModal.style.animation = 'slideDown 0.3s ease';
                    }
                });
            }

            if (closeBtn) {
                closeBtn.addEventListener('click', function() {
                    helpModal.style.display = 'none';
                });
            }

            // Close when clicking outside
            document.addEventListener('click', function(e) {
                if (helpModal && !helpModal.contains(e.target) &&
                    helpBtn && !helpBtn.contains(e.target)) {
                    helpModal.style.display = 'none';
                }
            });
        }

        // Mobile menu toggle
        function initMobileMenu() {
            const mobileMenuBtn = document.getElementById('mobileMenuBtn');
            const mobileMenuPanel = document.getElementById('mobileMenuPanel');

            if (mobileMenuBtn && mobileMenuPanel) {
                mobileMenuBtn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    mobileMenuPanel.style.display = 'block';
                    mobileMenuPanel.style.animation = 'fadeIn 0.3s ease';
                });
            }
        }

        // Close mobile menu (global function)
        window.closeMobileMenu = function() {
            const mobileMenuPanel = document.getElementById('mobileMenuPanel');
            if (mobileMenuPanel) {
                mobileMenuPanel.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => {
                    mobileMenuPanel.style.display = 'none';
                }, 300);
            }
        };

        // Profile dropdown toggle
        function initProfileDropdown() {
            const avatar = document.querySelector('.header-avatar');
            const profileDropdown = document.getElementById('profileDropdown');

            if (avatar && profileDropdown) {
                avatar.style.cursor = 'pointer';

                avatar.addEventListener('click', function(e) {
                    e.stopPropagation();

                    // Close other panels
                    const notificationPanel = document.getElementById('notificationPanel');
                    const helpModal = document.getElementById('helpModal');
                    if (notificationPanel) notificationPanel.style.display = 'none';
                    if (helpModal) helpModal.style.display = 'none';

                    // Toggle profile dropdown
                    profileDropdown.style.display = profileDropdown.style.display === 'none' ? 'block' : 'none';

                    // Add animation
                    if (profileDropdown.style.display === 'block') {
                        profileDropdown.style.animation = 'slideDown 0.3s ease';
                    }
                });
            }

            // Close when clicking outside
            document.addEventListener('click', function(e) {
                if (profileDropdown && !profileDropdown.contains(e.target) &&
                    avatar && !avatar.contains(e.target)) {
                    profileDropdown.style.display = 'none';
                }
            });

            // Handle logout
            const logoutLink = document.getElementById('logoutLink');
            if (logoutLink) {
                logoutLink.addEventListener('click', function(e) {
                    e.preventDefault();

                    // Show confirmation dialog
                    if (confirm('Are you sure you want to logout?')) {
                        // Close dropdown
                        profileDropdown.style.display = 'none';

                        // Add fade out animation
                        document.body.style.opacity = '0';
                        document.body.style.transition = 'opacity 0.3s ease';

                        // Simulate logout
                        setTimeout(() => {
                            // Clear any stored user data
                            sessionStorage.clear();
                            localStorage.removeItem('userToken');

                            // Redirect to login page
                            window.location.href = '../index.html';
                        }, 300);
                    }
                });
            }
        }

        // Add animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideDown {
                from {
                    opacity: 0;
                    transform: translateY(-10px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes fadeOut {
                from { opacity: 1; }
                to { opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Initialize all functionality
        function init() {
            setActiveNavLink();
            initNotificationPanel();
            initHelpModal();
            initMobileMenu();
            initProfileDropdown();
        }

        // Run init when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            // DOM already loaded, wait a bit for header to be injected
            setTimeout(init, 300);
        }
    })();
</script>
